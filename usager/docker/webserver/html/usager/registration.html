<!DOCTYPE html>
<html>
<head>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: Arial, sans-serif;
            background-color: #f7f7f7;
        }
        form {
            background-color: #ffffff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0px 0px 10px 0px rgba(0,0,0,0.1);
        }
        select, button {
            width: 100%;
            height: 40px;
            margin: 10px 0;
            padding: 0 10px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }
    </style>
    <!-- Include Axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>

<form>
    <label for="university-select">Choose a university:</label>
    <select id="university-select">
        <option value="">Select a university</option>
    </select>

    <label for="faculty-select">Choose a faculty:</label>
    <select id="faculty-select">
        <option value="">Select a faculty</option>
    </select>

    <button type="button" onclick="submitAndGoBack()">Submit</button>
</form>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        axios.get("http://localhost:8888/api/universities")
            .then(function (response) {
                const universityNames = response.data;
                const selectElement = document.getElementById('university-select');

                for (const name of universityNames) {
                    const option = document.createElement('option');
                    option.value = name;
                    option.text = name;
                    selectElement.appendChild(option);
                }
            })
            .catch(function (error) {
                console.error(error);
            });
    });

    document.getElementById('university-select').addEventListener('change', function() {
        const selectedUniversity = this.value;

        // Clear previous faculty options
        const facultySelect = document.getElementById('faculty-select');
        facultySelect.options.length = 0;
        facultySelect.options[0] = new Option('Select a faculty', '');

        axios.get("http://localhost:8888/api/universities/" + encodeURIComponent(selectedUniversity) + '/faculties')
            .then(function (response) {
                const facultyNames = response.data;

                for (const name of facultyNames) {
                    const option = document.createElement('option');
                    option.value = name;
                    option.text = name;
                    facultySelect.appendChild(option);
                }
            })
            .catch(function (error) {
                console.error(error);
            });
    });


    function submitAndGoBack() {
        const university = document.getElementById('university-select').value;
        const faculty = document.getElementById('faculty-select').value;

        /*
        Here you can call a function that sends a POST request to your server
        to update the database with the selected university and faculty.

        Example:
        axios.post('/api/submit', { university, faculty })
            .then(function (response) {
                // handle success
                console.log(response);
            })
            .catch(function (error) {
                // handle error
                console.error(error);
            });
        */

        // After the submission, you can go back to the previous page
        window.history.back();
    }
</script>

</body>
</html>
